maven settings.xml debug pickup azure devops

maven -X
...
[DEBUG] Reading global settings from /usr/share/apache-maven-3.6.3/conf/settings.xml
[DEBUG] Reading user settings from /home/vsts/.m2/settings.xml

maven caching

https://docs.microsoft.com/en-us/azure/devops/pipelines/release/caching?view=azure-devops

variables:
  MAVEN_CACHE_FOLDER: $(Pipeline.Workspace)/.m2/repository
  MAVEN_OPTS: '-Dmaven.repo.local=$(MAVEN_CACHE_FOLDER)'

steps:
- task: Cache@2
  inputs:
    key: 'maven | "$(Agent.OS)" | **/pom.xml'
    restoreKeys: |
      maven | "$(Agent.OS)"
      maven
    path: $(MAVEN_CACHE_FOLDER)
  displayName: Cache Maven local repo

- script: mvn install -B -e

- task: Maven@3
  inputs:
    mavenPomFile: 'pom.xml'
    mavenOptions: '-Xmx3072m $(MAVEN_OPTS)'
    
    - task: Cache@2
      displayName: Maven Repository Cache
      condition: eq('A', 'A')
      inputs:
        key: 'maven | "$(Agent.OS)" | **/pom.xml'
        restoreKeys: |
          maven | "$(Agent.OS)"
          maven
        path: $HOME/.m2/repository

    - task: AzureCLI@2
      displayName: 'Build Maven CLI'
      condition: eq('A', 'A')
      inputs:
        azureSubscription: 'AzureRMwithPowerSP'
        scriptType: 'bash'
        scriptLocation: 'inlineScript'
        inlineScript: |
          set -x
          mvn -B -e -X -Dmaven.repo.local=$HOME/.m2/repository -Dmaven.test.skip=true package
          
          
CNB:
/layers/paketo-buildpacks_maven/cache/repository
/home/cnb/.m2/repository

mvn -B -e -X -Dmaven.repo.local=/home/vsts/work/1/.m2/repository -Dmaven.test.skip=true package

Working:
mkdir -p mkdir maven/metadata && mkdir -p maven/secret
echo "maven" > maven/metadata/kind
cp -p $HOME/.m2/settings.xml maven/secret/settings.xml
tree maven 
cat maven/secret/settings.xml
export BP_JVM_VERSION=8
export BP_MAVEN_BUILD_ARGUMENTS="clean install -Dassertj.skip=true -Dmaven.test.skip=true"
export BP_MAVEN_BUILT_ARTIFACT=/yyy-app/target/yyy-app-0.8.15-SNAPSHOT.jar
./pack build xxx/yyy -p . --builder gcr.io/paketo-buildpacks/builder:base --env "BP_MAVEN_BUILT_ARTIFACT" --env "BP_JVM_VERSION" --env "BP_MAVEN_BUILD_ARGUMENTS" --volume $PWD/maven:/bindings/maven -v


Test:
export BP_MAVEN_BUILD_ARGUMENTS="clean install -Dassertj.skip=true -Dmaven.test.skip=true -Dmaven.repo.local=/platform/.m2/repository"

pack build slonline/kalkulation -p . --builder gcr.io/paketo-buildpacks/builder:base --env BP_MAVEN_BUILD_ARGUMENTS --env BP_JVM_VERSION --env BP_MAVEN_BUILT_ARTIFACT -v --volume $PWD/maven:/bindings/maven --volume ~/.m2:/.m2

Fails:
Failed to write tracking file /platform/.m2/repository/org/assertj/assertj-core/resolver-status.properties
[builder] java.io.FileNotFoundException: /platform/.m2/repository/org/assertj/assertj-core/resolver-status.properties (Read-only file system)

---

OBS Zoom

https://obsproject.com/

https://obsproject.com/wiki/OBS-Studio-Quickstart

https://support.shinywhitebox.com/hc/en-us/articles/204161459-Installing-iShowU-Audio-Capture

https://obsproject.com/forum/resources/obs-virtualcam.949/
https://streamshark.io/blog/using-obs-as-a-virtual-webcam-on-windows-and-macos/

< 5.0.4 no virtual camera support

https://obsproject.com/forum/threads/using-obs-to-stream-to-zoom-zoom-us.105410/

---

    - script: |
        set -x
        pwd
        ls -altr
        echo Pipeline.Workspace $(Pipeline.Workspace)
        echo Agent.HomeDirectory $(Agent.HomeDirectory)
        echo Build.ArtifactStagingDirectory $(Build.ArtifactStagingDirectory)
        echo Build.Repository.LocalPath $(Build.Repository.LocalPath)
        echo System.DefaultWorkingDirectory $(System.DefaultWorkingDirectory)
        echo user.home $(user.home)
        echo HOME $HOME
        ls $(Pipeline.Workspace)/.m2/
        cat /home/vsts/work/_temp/settings.xml
        cat /home/vsts/.m2/settings.xml
        ls -altr /home/vsts/work/_temp  
        ls -altr /home/vsts/work/1/ 
        ls -altr /home/vsts/work/
        git config --list  
        ls -altr /home/vsts   
        ls -altr /home/vsts/.m2/   
        echo hallo
      displayName: 'Show env'
      condition: always()
